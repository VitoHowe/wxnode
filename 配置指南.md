# å¾®ä¿¡å°ç¨‹åºé¢˜åº“ç®¡ç†ç³»ç»Ÿé…ç½®æŒ‡å—

**ç‰ˆæœ¬**: v1.2.0  
**æœ€åæ›´æ–°**: 2025-09-28

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒè¦æ±‚

- **Node.js**: >= 16.0.0
- **MySQL**: >= 8.0
- **Redis**: >= 6.0 (å¯é€‰ï¼Œå·²ç§»é™¤ä¾èµ–)
- **pnpm**: >= 7.0 (æ¨è) æˆ– npm

### 2. å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨pnpmï¼ˆæ¨èï¼‰
pnpm install

# æˆ–ä½¿ç”¨npm
npm install
```

### 3. ç¯å¢ƒé…ç½®

å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿æ–‡ä»¶ï¼š
```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
# ğŸ”§ æœåŠ¡å™¨é…ç½®
PORT=3001
NODE_ENV=development

# ğŸ—„ï¸ æ•°æ®åº“é…ç½®ï¼ˆå¿…éœ€ï¼‰
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_mysql_password
DB_NAME=wxnode_db

# ğŸ” JWTé…ç½®ï¼ˆå¿…éœ€ï¼‰
JWT_SECRET=your-super-secret-jwt-key-change-this
JWT_REFRESH_SECRET=your-super-secret-refresh-key-change-this

# ğŸ“± å¾®ä¿¡å°ç¨‹åºé…ç½®ï¼ˆå¯é€‰ï¼‰
WECHAT_APPID=your_wechat_miniprogram_appid
WECHAT_SECRET=your_wechat_miniprogram_secret

# ğŸ“¦ Redisé…ç½®ï¼ˆå¯é€‰ï¼Œç³»ç»Ÿå·²ç§»é™¤Redisä¾èµ–ï¼‰
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
```

## ğŸ”‘ é‡è¦é…ç½®è¯´æ˜

### æ•°æ®åº“é…ç½®
```env
DB_HOST=localhost        # æ•°æ®åº“ä¸»æœºåœ°å€
DB_PORT=3306            # æ•°æ®åº“ç«¯å£
DB_USER=root            # æ•°æ®åº“ç”¨æˆ·å
DB_PASSWORD=123456      # æ•°æ®åº“å¯†ç 
DB_NAME=wxnode_db       # æ•°æ®åº“åç§°
```

### JWTå®‰å…¨é…ç½®
```env
# å¼ºçƒˆå»ºè®®æ›´æ”¹é»˜è®¤å¯†é’¥ï¼
JWT_SECRET=your-unique-secret-key-2025
JWT_REFRESH_SECRET=your-unique-refresh-key-2025
```

### å¾®ä¿¡å°ç¨‹åºé…ç½®
```env
# ä»å¾®ä¿¡å…¬ä¼—å¹³å°è·å–: https://mp.weixin.qq.com/
WECHAT_APPID=wx1234567890abcdef
WECHAT_SECRET=1234567890abcdef1234567890abcdef
```

## ğŸ“Š æ•°æ®åº“è®¾ç½®

### è‡ªåŠ¨åˆå§‹åŒ–
ç³»ç»Ÿå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨ï¼š
- åˆ›å»ºæ•°æ®åº“ï¼ˆå¦‚ä¸å­˜åœ¨ï¼‰
- åˆ›å»ºæ‰€éœ€è¡¨ç»“æ„
- æ‰§è¡Œæ•°æ®åº“è¿ç§»
- æ’å…¥é»˜è®¤æ•°æ®

### æ‰‹åŠ¨åˆå§‹åŒ–ï¼ˆå¦‚éœ€è¦ï¼‰
```bash
# è¿æ¥MySQLå¹¶åˆ›å»ºæ•°æ®åº“
mysql -u root -p
CREATE DATABASE wxnode_db CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
```

## ğŸ¯ å¯åŠ¨æœåŠ¡

### å¼€å‘æ¨¡å¼
```bash
pnpm run dev
```

### ç”Ÿäº§æ¨¡å¼
```bash
# æ„å»ºé¡¹ç›®
pnpm run build

# å¯åŠ¨æœåŠ¡
pnpm start
```

## ğŸ“‹ åŠŸèƒ½éªŒè¯

### 1. åŸºç¡€å¥åº·æ£€æŸ¥
```bash
curl http://localhost:3001/health
```

é¢„æœŸå“åº”ï¼š
```json
{
  "status": "OK",
  "timestamp": "2025-09-28T14:12:19.123Z",
  "version": "1.2.0"
}
```

### 2. æ™®é€šç”¨æˆ·æ³¨å†Œæµ‹è¯•
```bash
curl -X POST http://localhost:3001/api/auth/register \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "TestPass123",
    "nickname": "æµ‹è¯•ç”¨æˆ·"
  }'
```

### 3. æ™®é€šç”¨æˆ·ç™»å½•æµ‹è¯•
```bash
curl -X POST http://localhost:3001/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{
    "username": "testuser",
    "password": "TestPass123"
  }'
```

## ğŸ”§ å¸¸è§é—®é¢˜

### Q: æ•°æ®åº“è¿æ¥å¤±è´¥
**A**: æ£€æŸ¥æ•°æ®åº“é…ç½®å’ŒMySQLæœåŠ¡çŠ¶æ€
```bash
# æ£€æŸ¥MySQLæœåŠ¡
sudo systemctl status mysql

# æµ‹è¯•è¿æ¥
mysql -h localhost -u root -p
```

### Q: å¾®ä¿¡ç™»å½•å¤±è´¥
**A**: æ£€æŸ¥å¾®ä¿¡å°ç¨‹åºé…ç½®
1. ç¡®è®¤APPIDå’ŒSECRETæ­£ç¡®
2. ç¡®è®¤å°ç¨‹åºåŸŸåå·²é…ç½®
3. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯

### Q: JWT Tokenæ— æ•ˆ
**A**: æ£€æŸ¥JWTå¯†é’¥é…ç½®
1. ç¡®è®¤JWT_SECRETå·²è®¾ç½®
2. ç¡®è®¤å¯†é’¥è¶³å¤Ÿå¤æ‚
3. é‡å¯æœåŠ¡ä½¿é…ç½®ç”Ÿæ•ˆ

## ğŸ“± å¾®ä¿¡å°ç¨‹åºé…ç½®

### 1. è·å–APPIDå’ŒSECRET
1. ç™»å½•å¾®ä¿¡å…¬ä¼—å¹³å°: https://mp.weixin.qq.com/
2. è¿›å…¥å¼€å‘ -> å¼€å‘ç®¡ç† -> å¼€å‘è®¾ç½®
3. å¤åˆ¶AppIDå’ŒAppSecret

### 2. é…ç½®æœåŠ¡å™¨åŸŸå
åœ¨å¾®ä¿¡å…¬ä¼—å¹³å°è®¾ç½®requeståˆæ³•åŸŸåï¼š
```
https://yourdomain.com
```

### 3. å°ç¨‹åºç«¯è°ƒç”¨ç¤ºä¾‹
```javascript
// app.js
wx.login({
  success: (res) => {
    wx.request({
      url: 'https://yourdomain.com/api/auth/login',
      method: 'POST',
      data: { code: res.code },
      success: (loginRes) => {
        if (loginRes.data.code === 200) {
          const { accessToken } = loginRes.data.data;
          wx.setStorageSync('token', accessToken);
        }
      }
    });
  }
});
```

## ğŸ›¡ï¸ å®‰å…¨å»ºè®®

### 1. ç”Ÿäº§ç¯å¢ƒé…ç½®
```env
NODE_ENV=production
JWT_SECRET=complex-random-string-at-least-32-chars
JWT_REFRESH_SECRET=another-complex-random-string
```

### 2. æ•°æ®åº“å®‰å…¨
- ä½¿ç”¨ä¸“ç”¨æ•°æ®åº“ç”¨æˆ·ï¼Œä¸è¦ä½¿ç”¨root
- è®¾ç½®å¼ºå¯†ç 
- é™åˆ¶æ•°æ®åº“è¿æ¥æ¥æº

### 3. HTTPSé…ç½®
ç”Ÿäº§ç¯å¢ƒå¼ºçƒˆå»ºè®®ä½¿ç”¨HTTPSï¼š
```bash
# ä½¿ç”¨nginxåå‘ä»£ç†
server {
    listen 443 ssl;
    server_name yourdomain.com;
    
    ssl_certificate /path/to/cert.pem;
    ssl_certificate_key /path/to/key.pem;
    
    location / {
        proxy_pass http://localhost:3001;
    }
}
```

## ğŸ“¦ Dockeréƒ¨ç½²ï¼ˆå¯é€‰ï¼‰

```dockerfile
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build
EXPOSE 3001
CMD ["npm", "start"]
```

```bash
# æ„å»ºé•œåƒ
docker build -t wxnode-api .

# è¿è¡Œå®¹å™¨
docker run -d -p 3001:3001 --env-file .env wxnode-api
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

é‡åˆ°é—®é¢˜è¯·æ£€æŸ¥ï¼š
1. æœåŠ¡å™¨æ—¥å¿—æ–‡ä»¶ `logs/` ç›®å½•
2. æ•°æ®åº“è¿æ¥çŠ¶æ€
3. ç¯å¢ƒå˜é‡é…ç½®
4. ç«¯å£æ˜¯å¦è¢«å ç”¨

---

**æç¤º**: é¦–æ¬¡å¯åŠ¨å¯èƒ½éœ€è¦å‡ ç§’é’Ÿè¿›è¡Œæ•°æ®åº“åˆå§‹åŒ–ï¼Œè¯·è€å¿ƒç­‰å¾…ã€‚
AIzaSyBWFXEPo6GYJspqhMcBryt5k-M3aOrusxg
AIzaSyAJ2P6LvxI0UZWM7YN49uBsi91RWZThogE